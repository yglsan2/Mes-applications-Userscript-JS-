// ==UserScript==
// @name KanbanExposÃ©
// @namespace http://tampermonkey.net/
// @version 2.0
// @description Kanban pour exposÃ©
// @author Yglsan
// @match *://*/*
// @grant GM_addStyle
// @grant GM_setValue
// @grant GM_getValue
// @grant GM_deleteValue
// @connect *
// @license GnuGPL 3.0
// ==/UserScript==

(function() {
    'use strict';
    GM_addStyle(`
        :root { --primary-color: #2c3e50; --secondary-color: #3498db; --success-color: #27ae60; --danger-color: #e74c3c; --background-color: #ecf0f1; --text-color: #2c3e50; --border-radius: 10px; --box-shadow: 0 4px 6px rgba(0,0,0,0.1); --transition: all 0.3s ease; }
        body { color: var(--text-color); background-color: var(--background-color); }
        #kanbanContainer { position: fixed; bottom: 30px; right: 30px; width: 800px; max-width: 90vw; background: white; border-radius: var(--border-radius); box-shadow: var(--box-shadow); font-family: 'Segoe UI', system-ui, sans-serif; z-index: 10000; display: none; flex-direction: column; max-height: 90vh; }
        .kanban-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem; background: var(--primary-color); color: white; border-radius: var(--border-radius) var(--border-radius) 0 0; }
        .kanban-title { font-size: 1.5rem; font-weight: 600; }
        .kanban-controls { display: flex; gap: 0.5rem; align-items: center; }
        .control-button { padding: 0.5rem 1rem; border: none; border-radius: 6px; cursor: pointer; background: rgba(255, 255, 255, 0.1); color: white; display: flex; align-items: center; gap: 0.5rem; transition: var(--transition); }
        .control-button:hover { background: rgba(255, 255, 255, 0.2); }
        .kanban-body { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; padding: 1.5rem; overflow-y: auto; flex-grow: 1; }
        .kanban-column { background: var(--background-color); border-radius: var(--border-radius); padding: 1rem; min-height: 400px; display: flex; flex-direction: column; gap: 1rem; }
        .column-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--primary-color); }
        .add-task-button { padding: 0.5rem 1rem; background: var(--secondary-color); color: white; border: none; border-radius: 6px; cursor: pointer; transition: var(--transition); display: flex; align-items: center; gap: 0.5rem; }
        .add-task-button:hover { background: #2980b9; }
        .kanban-task { background: white; padding: 1rem; border-radius: 6px; box-shadow: var(--box-shadow); cursor: grab; position: relative; transition: var(--transition); border-left: 4px solid transparent; }
        .kanban-task.dragging { opacity: 0.5; transform: rotate(3deg); }
        .task-content { display: flex; flex-direction: column; gap: 0.5rem; }
        .task-priority { font-size: 0.8em; padding: 0.2em 0.5em; border-radius: 4px; align-self: flex-start; }
        .priority-high { border-color: #e74c3c; background: #f9e2e2; }
        .priority-medium { border-color: #f1c40f; background: #fcf3cf; }
        .priority-low { border-color: #2ecc71; background: #e8f6ee; }
        .delete-task { position: absolute; top: 0.5rem; right: 0.5rem; cursor: pointer; opacity: 0; transition: var(--transition); color: var(--danger-color); }
        .kanban-task:hover .delete-task { opacity: 1; }
        #toggleKanban { position: fixed; bottom: 30px; right: 30px; padding: 1rem 1.5rem; background: var(--primary-color); color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: var(--box-shadow); display: flex; align-items: center; gap: 0.5rem; z-index: 9999; }
        .language-selector { position: relative; }
        .language-menu { position: absolute; right: 0; top: 100%; background: white; border-radius: var(--border-radius); box-shadow: var(--box-shadow); padding: 0.5rem; min-width: 150px; display: none; z-index: 10000; border: 1px solid var(--primary-color); color: black; }
        .language-option { padding: 0.5rem; cursor: pointer; border-radius: 4px; display: flex; align-items: center; gap: 0.5rem; }
        .language-option:hover { background: var(--background-color); }
        .size-button { padding: 0.5rem; border: none; border-radius: 6px; cursor: pointer; background: rgba(255, 255, 255, 0.1); color: white; display: flex; align-items: center; gap: 0.5rem; }
        .size-button:hover { background: rgba(255, 255, 255, 0.2); }
    `);

    const translations = {
        gb: { title: "Kanban Board", todo: "To Do", inProgress: "In Progress", done: "Done", addTask: "Add Task", export: "Export", import: "Import", language: "Language", delete: "Delete", confirmDelete: "Delete this task?", priority: "Priority", high: "High", medium: "Medium", low: "Low", cancel: "Cancel", save: "Save", resetConfirm: "Reset all tasks?", importError: "Invalid file format" },
        fr: { title: "Tableau Kanban", todo: "Ã€ Faire", inProgress: "En Cours", done: "TerminÃ©", addTask: "Ajouter TÃ¢che", export: "Exporter", import: "Importer", language: "Langue", delete: "Supprimer", confirmDelete: "Supprimer cette tÃ¢che ?", priority: "PrioritÃ©", high: "Haute", medium: "Moyenne", low: "Basse", cancel: "Annuler", save: "Enregistrer", resetConfirm: "RÃ©initialiser toutes les tÃ¢ches ?", importError: "Format de fichier invalide" },
        de: { title: "Kanban-Board", todo: "Zu Erledigen", inProgress: "In Bearbeitung", done: "Fertig", addTask: "Aufgabe HinzufÃ¼gen", export: "Exportieren", import: "Importieren", language: "Sprache", delete: "LÃ¶schen", confirmDelete: "Diese Aufgabe lÃ¶schen?", priority: "PrioritÃ¤t", high: "Hoch", medium: "Mittel", low: "Niedrig", cancel: "Abbrechen", save: "Speichern", resetConfirm: "Alle Aufgaben zurÃ¼cksetzen?", importError: "UngÃ¼ltiges Dateiformat" },
        it: { title: "Bacheca Kanban", todo: "Da Fare", inProgress: "In Corso", done: "Fatto", addTask: "Aggiungi Compito", export: "Esporta", import: "Importa", language: "Lingua", delete: "Elimina", confirmDelete: "Eliminare questo compito?", priority: "PrioritÃ ", high: "Alta", medium: "Media", low: "Bassa", cancel: "Annulla", save: "Salva", resetConfirm: "Ripristinare tutte le attivitÃ ?", importError: "Formato file non valido" },
        es: { title: "Tablero Kanban", todo: "Por Hacer", inProgress: "En Progreso", done: "Hecho", addTask: "Agregar Tarea", export: "Exportar", import: "Importar", language: "Idioma", delete: "Eliminar", confirmDelete: "Â¿Eliminar esta tarea?", priority: "Prioridad", high: "Alta", medium: "Media", low: "Baja", cancel: "Cancelar", save: "Guardar", resetConfirm: "Â¿Restablecer todas las tareas?", importError: "Formato de archivo no vÃ¡lido" },
        jp: { title: "ã‚«ãƒ³ãƒãƒ³ãƒœãƒ¼ãƒ‰", todo: "ã‚„ã‚‹ã“ã¨", inProgress: "é€²è¡Œä¸­", done: "å®Œäº†", addTask: "ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ", export: "ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ", import: "ã‚¤ãƒ³ãƒãƒ¼ãƒˆ", language: "è¨€èª", delete: "å‰Šé™¤", confirmDelete: "ã“ã®ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ", priority: "å„ªå…ˆåº¦", high: "é«˜", medium: "ä¸­", low: "ä½", cancel: "ã‚­ãƒ£ãƒ³ã‚»ãƒ«", save: "ä¿å­˜", resetConfirm: "ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ", importError: "ç„¡åŠ¹ãªãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼" },
        kr: { title: "ì¹¸ë°˜ ë³´ë“œ", todo: "í•´ì•¼ í•  ì¼", inProgress: "ì§„í–‰ ì¤‘", done: "ì™„ë£Œ", addTask: "ì‘ì—… ì¶”ê°€", export: "ë‚´ë³´ë‚´ê¸°", import: "ê°€ì ¸ì˜¤ê¸°", language: "ì–¸ì–´", delete: "ì‚­ì œ", confirmDelete: "ì´ ì‘ì—…ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?", priority: "ìš°ì„  ìˆœìœ„", high: "ë†’ìŒ", medium: "ì¤‘ê°„", low: "ë‚®ìŒ", cancel: "ì·¨ì†Œ", save: "ì €ì¥", resetConfirm: "ëª¨ë“  ì‘ì—…ì„ ì¬ì„¤ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?", importError: "ìœ íš¨í•˜ì§€ ì•Šì€ íŒŒì¼ í˜•ì‹" },
        cn: { title: "çœ‹æ¿", todo: "å¾…åŠäº‹é¡¹", inProgress: "è¿›è¡Œä¸­", done: "å®Œæˆ", addTask: "æ·»åŠ ä»»åŠ¡", export: "å¯¼å‡º", import: "å¯¼å…¥", language: "è¯­è¨€", delete: "åˆ é™¤", confirmDelete: "åˆ é™¤æ­¤ä»»åŠ¡ï¼Ÿ", priority: "ä¼˜å…ˆçº§", high: "é«˜", medium: "ä¸­", low: "ä½", cancel: "å–æ¶ˆ", save: "ä¿å­˜", resetConfirm: "é‡ç½®æ‰€æœ‰ä»»åŠ¡ï¼Ÿ", importError: "æ— æ•ˆçš„æ–‡ä»¶æ ¼å¼" },
        lv: { title: "Kanban dÄ“lis", todo: "JÄdara", inProgress: "ProcesÄ", done: "IzpildÄ«ts", addTask: "Pievienot uzdevumu", export: "EksportÄ“t", import: "ImportÄ“t", language: "Valoda", delete: "DzÄ“st", confirmDelete: "DzÄ“st Å¡o uzdevumu?", priority: "PrioritÄte", high: "Augsta", medium: "VidÄ“ja", low: "Zema", cancel: "Atcelt", save: "SaglabÄt", resetConfirm: "Atjaunot visus uzdevumus?", importError: "NederÄ«gs faila formÄts" },
        ru: { title: "Ğ”Ğ¾ÑĞºĞ° ĞšĞ°Ğ½Ğ±Ğ°Ğ½", todo: "Ğš Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ", inProgress: "Ğ’ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞµ", done: "Ğ¡Ğ´ĞµĞ»Ğ°Ğ½Ğ¾", addTask: "Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ", export: "Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚", import: "Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚", language: "Ğ¯Ğ·Ñ‹Ğº", delete: "Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ", confirmDelete: "Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ ÑÑ‚Ñƒ Ğ·Ğ°Ğ´Ğ°Ñ‡Ñƒ?", priority: "ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚", high: "Ğ’Ñ‹ÑĞ¾ĞºĞ¸Ğ¹", medium: "Ğ¡Ñ€ĞµĞ´Ğ½Ğ¸Ğ¹", low: "ĞĞ¸Ğ·ĞºĞ¸Ğ¹", cancel: "ĞÑ‚Ğ¼ĞµĞ½Ğ°", save: "Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚ÑŒ", resetConfirm: "Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ²ÑĞµ Ğ·Ğ°Ğ´Ğ°Ñ‡Ğ¸?", importError: "ĞĞµĞ²ĞµÑ€Ğ½Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ñ„Ğ°Ğ¹Ğ»Ğ°" },
        pt: { title: "Quadro Kanban", todo: "A Fazer", inProgress: "Em Progresso", done: "ConcluÃ­do", addTask: "Adicionar Tarefa", export: "Exportar", import: "Importar", language: "Idioma", delete: "Excluir", confirmDelete: "Excluir esta tarefa?", priority: "Prioridade", high: "Alta", medium: "MÃ©dia", low: "Baixa", cancel: "Cancelar", save: "Salvar", resetConfirm: "Redefinir todas as tarefas?", importError: "Formato de arquivo invÃ¡lido" },
        sa: { title: "Ù„ÙˆØ­Ø© ÙƒØ§Ù†Ø¨Ø§Ù†", todo: "Ù„Ù„Ù‚ÙŠØ§Ù… Ø¨Ù‡", inProgress: "Ù‚ÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯Ù…", done: "Ù…Ù†Ø¬Ø²", addTask: "Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù…Ø©", export: "ØªØµØ¯ÙŠØ±", import: "Ø§Ø³ØªÙŠØ±Ø§Ø¯", language: "Ù„ØºØ©", delete: "Ø­Ø°Ù", confirmDelete: "Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ù‡Ù…Ø©ØŸ", priority: "Ø£ÙˆÙ„ÙˆÙŠØ©", high: "Ø¹Ø§Ù„ÙŠØ©", medium: "Ù…ØªÙˆØ³Ø·Ø©", low: "Ù…Ù†Ø®ÙØ¶Ø©", cancel: "Ø¥Ù„ØºØ§Ø¡", save: "Ø­ÙØ¸", resetConfirm: "Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù‡Ø§Ù…ØŸ", importError: "ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ù…Ù„Ù ØºÙŠØ± ØµØ§Ù„Ø­" }
    };

    let currentLanguage = 'fr';
    let isVisible = false;
    let isDraggingTask = false;

    const kanbanHTML = `
        <div class="kanban-header">
            <div class="kanban-title">${translations[currentLanguage].title}</div>
            <div class="kanban-controls">
                <button class="control-button" id="exportBtn"><span>â†“</span> ${translations[currentLanguage].export}</button>
                <button class="control-button" id="importBtn"><span>â†‘</span> ${translations[currentLanguage].import}</button>
                <div class="language-selector">
                    <button class="control-button" id="languageBtn">ğŸŒ ${translations[currentLanguage].language}</button>
                    <div class="language-menu">
                        ${Object.entries(translations).map(([code, lang]) =>
                            `<div class="language-option" data-lang="${code}"><img src="https://flagcdn.com/w20/${code}.png" alt="${code}" style="width: 20px; height: 20px;"> ${lang.title}</div>`
                        ).join('')}
                    </div>
                </div>
                <div class="size-selector">
                    <button class="size-button" data-size="small">ğŸ“</button>
                    <button class="size-button" data-size="medium">ğŸ“</button>
                    <button class="size-button" data-size="large">ğŸ“Š</button>
                </div>
            </div>
        </div>
        <div class="kanban-body">
            <div class="kanban-column" id="todo">
                <div class="column-header">
                    <h3>${translations[currentLanguage].todo}</h3>
                    <button class="add-task-button">+ ${translations[currentLanguage].addTask}</button>
                </div>
            </div>
            <div class="kanban-column" id="inProgress">
                <div class="column-header">
                    <h3>${translations[currentLanguage].inProgress}</h3>
                    <button class="add-task-button">+ ${translations[currentLanguage].addTask}</button>
                </div>
            </div>
            <div class="kanban-column" id="done">
                <div class="column-header">
                    <h3>${translations[currentLanguage].done}</h3>
                    <button class="add-task-button">+ ${translations[currentLanguage].addTask}</button>
                </div>
            </div>
        </div>
    `;

    const container = document.createElement('div');
    container.id = 'kanbanContainer';
    container.innerHTML = kanbanHTML;
    document.body.appendChild(container);

    const toggleBtn = document.createElement('button');
    toggleBtn.id = 'toggleKanban';
    toggleBtn.textContent = translations[currentLanguage].title;
    document.body.appendChild(toggleBtn);

    let tasks = JSON.parse(GM_getValue('kanbanTasks', '[]'));
    let dragTask = null;

    function initKanban() {
        tasks.forEach(task => createTaskElement(task));
        setupDragAndDrop();
        document.querySelectorAll('.add-task-button').forEach(btn => {
            btn.addEventListener('click', showTaskForm);
        });
        document.getElementById('languageBtn').addEventListener('click', toggleLanguageMenu);
        document.querySelectorAll('.language-option').forEach(option => {
            option.addEventListener('click', changeLanguage);
        });
        document.getElementById('exportBtn').addEventListener('click', exportTasks);
        document.getElementById('importBtn').addEventListener('click', importTasks);
        document.querySelectorAll('.size-button').forEach(button => {
            button.addEventListener('click', changeSize);
        });
        toggleBtn.addEventListener('click', () => {
            isVisible = !isVisible;
            container.style.display = isVisible ? 'flex' : 'none';
            toggleBtn.textContent = isVisible ? `â–² ${translations[currentLanguage].title}` : `â–¼ ${translations[currentLanguage].title}`;
        });
        makeDraggable(container);
    }

    function createTaskElement(taskData) {
        const task = document.createElement('div');
        task.className = `kanban-task priority-${taskData.priority}`;
        task.draggable = true;
        task.innerHTML = `
            <div class="task-content">
                <div>${taskData.text}</div>
                <div class="task-priority">${translations[currentLanguage][taskData.priority]}</div>
            </div>
            <div class="delete-task">Ã—</div>
        `;
        task.querySelector('.delete-task').addEventListener('click', () => {
            if (confirm(translations[currentLanguage].confirmDelete)) {
                task.remove();
                saveTasks();
            }
        });
        document.getElementById(taskData.column).appendChild(task);
        return task;
    }

    function showTaskForm(e) {
        const columnId = e.target.closest('.kanban-column').id;
        const form = document.createElement('div');
        form.className = 'task-form';
        form.innerHTML = `
            <input type="text" placeholder="${translations[currentLanguage].addTask}">
            <select>
                <option value="low">${translations[currentLanguage].low}</option>
                <option value="medium">${translations[currentLanguage].medium}</option>
                <option value="high">${translations[currentLanguage].high}</option>
            </select>
            <button class="save-btn">${translations[currentLanguage].save}</button>
            <button class="cancel-btn">${translations[currentLanguage].cancel}</button>
        `;
        form.querySelector('.save-btn').addEventListener('click', () => {
            const text = form.querySelector('input').value;
            const priority = form.querySelector('select').value;
            if (text) {
                const task = { text, priority, column: columnId };
                tasks.push(task);
                createTaskElement(task);
                saveTasks();
                form.remove();
            }
        });
        form.querySelector('.cancel-btn').addEventListener('click', () => form.remove());
        e.target.closest('.kanban-column').appendChild(form);
    }

    function setupDragAndDrop() {
        document.querySelectorAll('.kanban-task').forEach(task => {
            task.addEventListener('dragstart', () => {
                isDraggingTask = true;
                dragTask = task;
                task.classList.add('dragging');
            });
            task.addEventListener('dragend', () => {
                isDraggingTask = false;
                dragTask = null;
                task.classList.remove('dragging');
                saveTasks();
            });
        });
        document.querySelectorAll('.kanban-column').forEach(column => {
            column.addEventListener('dragover', e => {
                e.preventDefault();
                const afterElement = getDragAfterElement(column, e.clientY);
                const draggable = document.querySelector('.dragging');
                if (afterElement) {
                    column.insertBefore(draggable, afterElement);
                } else {
                    column.appendChild(draggable);
                }
            });
            column.addEventListener('drop', e => {
                e.preventDefault();
                const draggable = document.querySelector('.dragging');
                if (draggable) {
                    column.appendChild(draggable);
                    saveTasks();
                }
            });
        });
    }

    function getDragAfterElement(column, y) {
        return [...column.querySelectorAll('.kanban-task:not(.dragging)')]
            .reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                return offset < 0 && offset > closest.offset ? { offset: offset, element: child } : closest;
            }, { offset: Number.NEGATIVE_INFINITY }).element;
    }

    function saveTasks() {
        tasks = [];
        document.querySelectorAll('.kanban-column').forEach(column => {
            column.querySelectorAll('.kanban-task').forEach(task => {
                tasks.push({
                    text: task.querySelector('.task-content div').textContent,
                    priority: task.className.match(/priority-(low|medium|high)/)[1],
                    column: column.id
                });
            });
        });
        GM_setValue('kanbanTasks', JSON.stringify(tasks));
    }

    function exportTasks() {
        const data = JSON.stringify(tasks, null, 2);
        const blob = new Blob([data], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `kanban-${new Date().toISOString()}.json`;
        a.click();
    }

    function importTasks() {
        const input = document.createElement('input');
        input.type = 'file';
        input.accept = 'application/json';
        input.addEventListener('change', e => {
            const file = e.target.files[0];
            const reader = new FileReader();
            reader.onload = () => {
                try {
                    const newTasks = JSON.parse(reader.result);
                    document.querySelectorAll('.kanban-task').forEach(t => t.remove());
                    newTasks.forEach(task => createTaskElement(task));
                    saveTasks();
                } catch {
                    alert(translations[currentLanguage].importError);
                }
            };
            reader.readAsText(file);
        });
        input.click();
    }

    function toggleLanguageMenu(e) {
        const menu = document.querySelector('.language-menu');
        menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
        e.stopPropagation();
    }

    function changeLanguage(e) {
        currentLanguage = e.target.dataset.lang;
        document.querySelectorAll('.kanban-title').forEach(el => {
            el.textContent = translations[currentLanguage].title;
        });
        document.querySelectorAll('.kanban-column h3').forEach((el, index) => {
            const keys = ['todo', 'inProgress', 'done'];
            el.textContent = translations[currentLanguage][keys[index]];
        });
        document.querySelectorAll('.add-task-button').forEach(el => {
            el.innerHTML = `+ ${translations[currentLanguage].addTask}`;
        });
        document.getElementById('exportBtn').textContent = `â†“ ${translations[currentLanguage].export}`;
        document.getElementById('importBtn').textContent = `â†‘ ${translations[currentLanguage].import}`;
        document.getElementById('languageBtn').textContent = `ğŸŒ ${translations[currentLanguage].language}`;
        toggleBtn.textContent = translations[currentLanguage].title;
        saveTasks();
        document.querySelector('.language-menu').style.display = 'none';
    }

    function changeSize(e) {
        const size = e.target.dataset.size;
        switch(size) {
            case 'small': container.style.width = '400px'; break;
            case 'medium': container.style.width = '800px'; break;
            case 'large': container.style.width = '1200px'; break;
        }
    }

    function makeDraggable(element) {
        let offsetX, offsetY;
        element.addEventListener('mousedown', (e) => {
            if (isDraggingTask) return;
            offsetX = e.clientX - element.getBoundingClientRect().left;
            offsetY = e.clientY - element.getBoundingClientRect().top;
            document.addEventListener('mousemove', mouseMoveHandler);
            document.addEventListener('mouseup', mouseUpHandler);
        });
        function mouseMoveHandler(e) {
            element.style.left = `${e.clientX - offsetX}px`;
            element.style.top = `${e.clientY - offsetY}px`;
            element.style.position = 'absolute';
        }
        function mouseUpHandler() {
            document.removeEventListener('mousemove', mouseMoveHandler);
            document.removeEventListener('mouseup', mouseUpHandler);
        }
    }

    initKanban();
    document.addEventListener('click', () => {
        document.querySelector('.language-menu').style.display = 'none';
    });
    window.addEventListener('resize', () => {
        container.style.width = window.innerWidth < 768 ? '95vw' : '800px';
    });
})();
